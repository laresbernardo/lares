<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Machine Learning • lares</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Machine Learning">
<!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-166493168-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-166493168-2');
</script>
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">lares</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">5.3.3.9006</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/api-integrations.html">API Integrations</a></li>
    <li><a class="dropdown-item" href="../articles/data-wrangling.html">Data Wrangling &amp; Visualization</a></li>
    <li><a class="dropdown-item" href="../articles/games.html">Games &amp; Puzzles</a></li>
    <li><a class="dropdown-item" href="../articles/machine-learning.html">Machine Learning</a></li>
    <li><a class="dropdown-item" href="../articles/robyn_lares.html">Robyn Enhancers</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/laresbernardo/lares/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Machine Learning</h1>
                        <h4 data-toc-skip class="author">Bernardo
Lares</h4>
            
            <h4 data-toc-skip class="date">2025-11-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/laresbernardo/lares/blob/main/vignettes/machine-learning.Rmd" class="external-link"><code>vignettes/machine-learning.Rmd</code></a></small>
      <div class="d-none name"><code>machine-learning.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>The <code>lares</code> package provides a streamlined interface to
h2o’s AutoML for automated machine learning. This vignette demonstrates
how to build, evaluate, and interpret models with minimal code.</p>
</div>
<div class="section level2">
<h2 id="setup">Setup<a class="anchor" aria-label="anchor" href="#setup"></a>
</h2>
<p>Install and load required packages:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/laresbernardo/lares" class="external-link">lares</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org" class="external-link">dplyr</a></span><span class="op">)</span></span></code></pre></div>
<p>h2o must be installed separately:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Install h2o (run once)</span></span>
<span><span class="co"># install.packages("h2o")</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/h2oai/h2o-3" class="external-link">h2o</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Initialize h2o quietly for vignette</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.unsetenv</a></span><span class="op">(</span><span class="st">"http_proxy"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Sys.setenv.html" class="external-link">Sys.unsetenv</a></span><span class="op">(</span><span class="st">"https_proxy"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.init.html" class="external-link">h2o.init</a></span><span class="op">(</span>nthreads <span class="op">=</span> <span class="op">-</span><span class="fl">1</span>, max_mem_size <span class="op">=</span> <span class="st">"2G"</span>, ip <span class="op">=</span> <span class="st">"localhost"</span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; H2O is not running yet, starting it now...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Note:  In case of errors look at the following log files:</span></span>
<span><span class="co">#&gt;     /tmp/RtmpcWj43R/file256037072506/h2o_runner_started_from_r.out</span></span>
<span><span class="co">#&gt;     /tmp/RtmpcWj43R/file25607a88de01/h2o_runner_started_from_r.err</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Starting H2O JVM and connecting: ... Connection successful!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R is connected to the H2O cluster: </span></span>
<span><span class="co">#&gt;     H2O cluster uptime:         1 seconds 501 milliseconds </span></span>
<span><span class="co">#&gt;     H2O cluster timezone:       UTC </span></span>
<span><span class="co">#&gt;     H2O data parsing timezone:  UTC </span></span>
<span><span class="co">#&gt;     H2O cluster version:        3.44.0.3 </span></span>
<span><span class="co">#&gt;     H2O cluster version age:    1 year, 11 months and 5 days </span></span>
<span><span class="co">#&gt;     H2O cluster name:           H2O_started_from_R_runner_mwl453 </span></span>
<span><span class="co">#&gt;     H2O cluster total nodes:    1 </span></span>
<span><span class="co">#&gt;     H2O cluster total memory:   2.00 GB </span></span>
<span><span class="co">#&gt;     H2O cluster total cores:    4 </span></span>
<span><span class="co">#&gt;     H2O cluster allowed cores:  4 </span></span>
<span><span class="co">#&gt;     H2O cluster healthy:        TRUE </span></span>
<span><span class="co">#&gt;     H2O Connection ip:          localhost </span></span>
<span><span class="co">#&gt;     H2O Connection port:        54321 </span></span>
<span><span class="co">#&gt;     H2O Connection proxy:       NA </span></span>
<span><span class="co">#&gt;     H2O Internal Security:      FALSE </span></span>
<span><span class="co">#&gt;     R Version:                  R version 4.5.2 (2025-10-31)</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.no_progress.html" class="external-link">h2o.no_progress</a></span><span class="op">(</span><span class="op">)</span> <span class="co"># Disable progress bars</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="pipeline">Pipeline<a class="anchor" aria-label="anchor" href="#pipeline"></a>
</h2>
<p><img src="../reference/figures/automl_map.png" alt="h2o_automl workflow" width="100%"></p>
<p>In short, these are the steps that happen on
<code>h2o_automl</code>’s backend:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Input Processing</strong>: The function receives a
dataframe <code>df</code> and the dependent variable <code>y</code> to
predict. Set <code>seed</code> for reproducibility.</p></li>
<li><p><strong>Model Type Detection</strong>: Automatically decides
between classification (categorical) or regression (continuous) based on
<code>y</code>’s class and unique values (controlled by
<code>thresh</code> parameter).</p></li>
<li><p><strong>Data Splitting</strong>: Splits data into test and train
datasets. Control the proportion with <code>split</code> parameter.
Replicate this with <code><a href="../reference/msplit.html">msplit()</a></code>.</p></li>
<li>
<p><strong>Preprocessing</strong>:</p>
<ul>
<li>Center and scale numerical values</li>
<li>Remove outliers with <code>no_outliers</code>
</li>
<li>Impute missing values with MICE (<code>impute = TRUE</code>)</li>
<li>Balance training data for classification
(<code>balance = TRUE</code>)</li>
<li>Replicate with <code><a href="../reference/model_preprocess.html">model_preprocess()</a></code>
</li>
</ul>
</li>
<li>
<p><strong>Model Training</strong>: Runs
<code><a href="https://rdrr.io/pkg/h2o/man/h2o.automl.html" class="external-link">h2o::h2o.automl()</a></code> to train multiple models and generate a
leaderboard sorted by performance. Customize with:</p>
<ul>
<li>
<code>max_models</code> or <code>max_time</code>
</li>
<li>
<code>nfolds</code> for k-fold cross-validation</li>
<li>
<code>exclude_algos</code> and <code>include_algos</code>
</li>
</ul>
</li>
<li><p><strong>Model Selection</strong>: Selects the best model based on
performance metric (change with <code>stopping_metric</code>). Use
<code><a href="../reference/h2o_selectmodel.html">h2o_selectmodel()</a></code> to choose an alternative.</p></li>
<li><p><strong>Performance Evaluation</strong>: Calculates metrics and
plots using test predictions (unseen data). Replicate with
<code><a href="../reference/model_metrics.html">model_metrics()</a></code>.</p></li>
<li><p><strong>Results</strong>: Returns a list with inputs,
leaderboard, best model, metrics, and plots. Export with
<code><a href="../reference/export_results.html">export_results()</a></code>.</p></li>
</ol>
</div>
<div class="section level2">
<h2 id="quick-start-binary-classification">Quick Start: Binary Classification<a class="anchor" aria-label="anchor" href="#quick-start-binary-classification"></a>
</h2>
<p>Let’s build a model to predict Titanic survival:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">dft</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Train an AutoML model</span></span>
<span><span class="co"># Binary classification</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/h2o_automl.html">h2o_automl</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">dft</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Survived"</span>,</span>
<span>  target <span class="op">=</span> <span class="st">"TRUE"</span>,</span>
<span>  ignore <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ticket"</span>, <span class="st">"Cabin"</span>, <span class="st">"PassengerId"</span><span class="op">)</span>,</span>
<span>  max_models <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  max_time <span class="op">=</span> <span class="fl">120</span>,</span>
<span>  impute <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   tag       n     p order  pcum</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> FALSE   549  61.6     1  61.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> TRUE    342  38.4     2 100</span></span>
<span><span class="co">#&gt; train_size  test_size </span></span>
<span><span class="co">#&gt;        623        268</span></span>
<span><span class="co">#&gt;                         model_id       auc   logloss     aucpr</span></span>
<span><span class="co">#&gt; 1 XRT_1_AutoML_1_20251125_181343 0.8613359 0.4448440 0.8211963</span></span>
<span><span class="co">#&gt; 2 GBM_2_AutoML_1_20251125_181343 0.8583649 0.4320854 0.8205075</span></span>
<span><span class="co">#&gt; 3 GBM_3_AutoML_1_20251125_181343 0.8575161 0.4377482 0.8097954</span></span>
<span><span class="co">#&gt;   mean_per_class_error      rmse       mse</span></span>
<span><span class="co">#&gt; 1            0.1982924 0.3732340 0.1393036</span></span>
<span><span class="co">#&gt; 2            0.1918985 0.3664474 0.1342837</span></span>
<span><span class="co">#&gt; 3            0.2041406 0.3698799 0.1368111</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Model (1/10): XRT_1_AutoML_1_20251125_181343</span></span>
<span><span class="co">#&gt; Dependent Variable: Survived</span></span>
<span><span class="co">#&gt; Type: Classification (2 classes)</span></span>
<span><span class="co">#&gt; Algorithm: DRF</span></span>
<span><span class="co">#&gt; Split: 70% training data (of 891 observations)</span></span>
<span><span class="co">#&gt; Seed: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test metrics:</span></span>
<span><span class="co">#&gt;    AUC = 0.87014</span></span>
<span><span class="co">#&gt;    ACC = 0.16045</span></span>
<span><span class="co">#&gt;    PRC = 0.12903</span></span>
<span><span class="co">#&gt;    TPR = 0.18182</span></span>
<span><span class="co">#&gt;    TNR = 0.14557</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Most important variables:</span></span>
<span><span class="co">#&gt;    Sex (27.1%)</span></span>
<span><span class="co">#&gt;    Fare (23.6%)</span></span>
<span><span class="co">#&gt;    Age (21.4%)</span></span>
<span><span class="co">#&gt;    Pclass (13.1%)</span></span>
<span><span class="co">#&gt;    SibSp (5.6%)</span></span>
<span></span>
<span><span class="co"># View results</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt; Model (1/10): XRT_1_AutoML_1_20251125_181343</span></span>
<span><span class="co">#&gt; Dependent Variable: Survived</span></span>
<span><span class="co">#&gt; Type: Classification (2 classes)</span></span>
<span><span class="co">#&gt; Algorithm: DRF</span></span>
<span><span class="co">#&gt; Split: 70% training data (of 891 observations)</span></span>
<span><span class="co">#&gt; Seed: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test metrics:</span></span>
<span><span class="co">#&gt;    AUC = 0.87014</span></span>
<span><span class="co">#&gt;    ACC = 0.16045</span></span>
<span><span class="co">#&gt;    PRC = 0.12903</span></span>
<span><span class="co">#&gt;    TPR = 0.18182</span></span>
<span><span class="co">#&gt;    TNR = 0.14557</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Most important variables:</span></span>
<span><span class="co">#&gt;    Sex (27.1%)</span></span>
<span><span class="co">#&gt;    Fare (23.6%)</span></span>
<span><span class="co">#&gt;    Age (21.4%)</span></span>
<span><span class="co">#&gt;    Pclass (13.1%)</span></span>
<span><span class="co">#&gt;    SibSp (5.6%)</span></span></code></pre></div>
<p>That’s it! <code><a href="../reference/h2o_automl.html">h2o_automl()</a></code> handles:</p>
<ul>
<li>Train/test split</li>
<li>One-hot encoding of categorical variables</li>
<li>Model training with multiple algorithms</li>
<li>Hyperparameter tuning</li>
<li>Model selection</li>
</ul>
</div>
<div class="section level2">
<h2 id="understanding-the-output">Understanding the Output<a class="anchor" aria-label="anchor" href="#understanding-the-output"></a>
</h2>
<p>The model object contains:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] "model"           "y"               "scores_test"     "metrics"        </span></span>
<span><span class="co">#&gt;  [5] "parameters"      "importance"      "datasets"        "scoring_history"</span></span>
<span><span class="co">#&gt;  [9] "categoricals"    "type"            "split"           "threshold"      </span></span>
<span><span class="co">#&gt; [13] "model_name"      "algorithm"       "leaderboard"     "project"        </span></span>
<span><span class="co">#&gt; [17] "ignored"         "seed"            "h2o"             "plots"</span></span></code></pre></div>
<p>Key components: - <code>model</code>: Best h2o model -
<code>metrics</code>: Performance metrics - <code>importance</code>:
Variable importance - <code>datasets</code>: Train/test data used -
<code>parameters</code>: Configuration used</p>
</div>
<div class="section level2">
<h2 id="model-performance">Model Performance<a class="anchor" aria-label="anchor" href="#model-performance"></a>
</h2>
<div class="section level3">
<h3 id="metrics">Metrics<a class="anchor" aria-label="anchor" href="#metrics"></a>
</h3>
<p>View detailed metrics:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># All metrics</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">metrics</span></span>
<span><span class="co">#&gt; $dictionary</span></span>
<span><span class="co">#&gt; [1] "AUC: Area Under the Curve"                                                             </span></span>
<span><span class="co">#&gt; [2] "ACC: Accuracy"                                                                         </span></span>
<span><span class="co">#&gt; [3] "PRC: Precision = Positive Predictive Value"                                            </span></span>
<span><span class="co">#&gt; [4] "TPR: Sensitivity = Recall = Hit rate = True Positive Rate"                             </span></span>
<span><span class="co">#&gt; [5] "TNR: Specificity = Selectivity = True Negative Rate"                                   </span></span>
<span><span class="co">#&gt; [6] "Logloss (Error): Logarithmic loss [Neutral classification: 0.69315]"                   </span></span>
<span><span class="co">#&gt; [7] "Gain: When best n deciles selected, what % of the real target observations are picked?"</span></span>
<span><span class="co">#&gt; [8] "Lift: When best n deciles selected, how much better than random is?"                   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $confusion_matrix</span></span>
<span><span class="co">#&gt;        Pred</span></span>
<span><span class="co">#&gt; Real    FALSE TRUE</span></span>
<span><span class="co">#&gt;   FALSE    23  135</span></span>
<span><span class="co">#&gt;   TRUE     90   20</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gain_lift</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 10</span></span></span>
<span><span class="co">#&gt;    percentile value random target total  gain optimal   lift response score</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1          TRUE    10.1     26    27  23.6    24.5 135.      23.6  85.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2          TRUE    20.1     25    27  46.4    49.1 130.      22.7  77.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3          TRUE    30.2     19    27  63.6    73.6 111.      17.3  62.9 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4          TRUE    39.9     18    26  80      97.3 100.      16.4  53.6 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5          TRUE    50        5    27  84.5   100    69.1      4.55 37.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6          TRUE    60.1      4    27  88.2   100    46.8      3.64 22.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7          TRUE    69.8      3    26  90.9   100    30.3      2.73 17.6 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8          TRUE    79.9      3    27  93.6   100    17.3      2.73 11.8 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9          TRUE    89.9      2    27  95.5   100     6.15     1.82  9.25</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10         TRUE   100        5    27 100     100     0        4.55  3.05</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metrics</span></span>
<span><span class="co">#&gt;       AUC     ACC     PRC     TPR     TNR</span></span>
<span><span class="co">#&gt; 1 0.87014 0.16045 0.12903 0.18182 0.14557</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cv_metrics</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 8</span></span></span>
<span><span class="co">#&gt;    metric     mean     sd cv_1_valid cv_2_valid cv_3_valid cv_4_valid cv_5_valid</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> accuracy  0.824 0.043<span style="text-decoration: underline;">0</span>      0.84       0.8        0.76       0.855      0.863</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> auc       0.863 0.030<span style="text-decoration: underline;">6</span>      0.850      0.848      0.835      0.868      0.913</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> err       0.176 0.043<span style="text-decoration: underline;">0</span>      0.16       0.2        0.24       0.145      0.137</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> err_cou… 22     5.43       20         25         30         18         17    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> f0point5  0.753 0.063<span style="text-decoration: underline;">8</span>      0.780      0.662      0.710      0.806      0.804</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> f1        0.771 0.056<span style="text-decoration: underline;">6</span>      0.744      0.713      0.746      0.795      0.857</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> f2        0.794 0.075<span style="text-decoration: underline;">5</span>      0.711      0.771      0.786      0.785      0.917</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> lift_to…  2.74  0.418       2.98       3.29       2.31       2.76       2.34 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> logloss   0.445 0.031<span style="text-decoration: underline;">1</span>      0.443      0.447      0.495      0.429      0.412</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> max_per…  0.246 0.046<span style="text-decoration: underline;">4</span>      0.310      0.207      0.282      0.222      0.211</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> mcc       0.632 0.085<span style="text-decoration: underline;">8</span>      0.632      0.574      0.528      0.683      0.745</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> mean_pe…  0.818 0.041<span style="text-decoration: underline;">1</span>      0.803      0.804      0.767      0.838      0.875</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> mean_pe…  0.182 0.041<span style="text-decoration: underline;">1</span>      0.197      0.196      0.233      0.162      0.125</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> mse       0.140 0.012<span style="text-decoration: underline;">5</span>      0.139      0.142      0.160      0.132      0.127</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> pr_auc    0.821 0.063<span style="text-decoration: underline;">9</span>      0.789      0.726      0.842      0.859      0.887</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> precisi…  0.742 0.079<span style="text-decoration: underline;">2</span>      0.806      0.633      0.688      0.814      0.773</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> r2        0.394 0.062<span style="text-decoration: underline;">0</span>      0.375      0.331      0.350      0.430      0.483</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> recall    0.812 0.098<span style="text-decoration: underline;">2</span>      0.690      0.816      0.815      0.778      0.962</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> rmse      0.374 0.016<span style="text-decoration: underline;">6</span>      0.373      0.376      0.399      0.363      0.356</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> specifi…  0.823 0.082<span style="text-decoration: underline;">7</span>      0.916      0.793      0.718      0.899      0.789</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $max_metrics</span></span>
<span><span class="co">#&gt;                         metric  threshold       value idx</span></span>
<span><span class="co">#&gt; 1                       max f1 0.44946127   0.7510730 177</span></span>
<span><span class="co">#&gt; 2                       max f2 0.25424888   0.8025177 253</span></span>
<span><span class="co">#&gt; 3                 max f0point5 0.55592053   0.7894737 142</span></span>
<span><span class="co">#&gt; 4                 max accuracy 0.55592053   0.8250401 142</span></span>
<span><span class="co">#&gt; 5                max precision 0.97353023   1.0000000   0</span></span>
<span><span class="co">#&gt; 6                   max recall 0.03556724   1.0000000 397</span></span>
<span><span class="co">#&gt; 7              max specificity 0.97353023   1.0000000   0</span></span>
<span><span class="co">#&gt; 8             max absolute_mcc 0.55592053   0.6183650 142</span></span>
<span><span class="co">#&gt; 9   max min_per_class_accuracy 0.38891733   0.7902813 197</span></span>
<span><span class="co">#&gt; 10 max mean_per_class_accuracy 0.44946127   0.8017076 177</span></span>
<span><span class="co">#&gt; 11                     max tns 0.97353023 391.0000000   0</span></span>
<span><span class="co">#&gt; 12                     max fns 0.97353023 230.0000000   0</span></span>
<span><span class="co">#&gt; 13                     max fps 0.02230149 391.0000000 399</span></span>
<span><span class="co">#&gt; 14                     max tps 0.03556724 232.0000000 397</span></span>
<span><span class="co">#&gt; 15                     max tnr 0.97353023   1.0000000   0</span></span>
<span><span class="co">#&gt; 16                     max fnr 0.97353023   0.9913793   0</span></span>
<span><span class="co">#&gt; 17                     max fpr 0.02230149   1.0000000 399</span></span>
<span><span class="co">#&gt; 18                     max tpr 0.03556724   1.0000000 397</span></span>
<span></span>
<span><span class="co"># Specific metrics</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">metrics</span><span class="op">$</span><span class="va">AUC</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">metrics</span><span class="op">$</span><span class="va">Accuracy</span></span>
<span><span class="co">#&gt; NULL</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">metrics</span><span class="op">$</span><span class="va">Logloss</span></span>
<span><span class="co">#&gt; NULL</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="confusion-matrix">Confusion Matrix<a class="anchor" aria-label="anchor" href="#confusion-matrix"></a>
</h3>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Confusion matrix plot</span></span>
<span><span class="fu"><a href="../reference/mplot_conf.html">mplot_conf</a></span><span class="op">(</span></span>
<span>  tag <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">tag</span>,</span>
<span>  score <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">score</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"AUC: %.3f"</span>, <span class="va">model</span><span class="op">$</span><span class="va">metrics</span><span class="op">$</span><span class="va">metrics</span><span class="op">$</span><span class="va">AUC</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="machine-learning_files/figure-html/unnamed-chunk-6-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level3">
<h3 id="roc-curve">ROC Curve<a class="anchor" aria-label="anchor" href="#roc-curve"></a>
</h3>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># ROC curve</span></span>
<span><span class="fu"><a href="../reference/mplot_roc.html">mplot_roc</a></span><span class="op">(</span></span>
<span>  tag <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">tag</span>,</span>
<span>  score <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">score</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="machine-learning_files/figure-html/unnamed-chunk-7-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level3">
<h3 id="gain-and-lift-charts">Gain and Lift Charts<a class="anchor" aria-label="anchor" href="#gain-and-lift-charts"></a>
</h3>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Gain and Lift charts for binary classification</span></span>
<span><span class="fu"><a href="../reference/mplot_gain.html">mplot_gain</a></span><span class="op">(</span></span>
<span>  tag <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">tag</span>,</span>
<span>  score <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">score</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="machine-learning_files/figure-html/unnamed-chunk-8-1.png" class="r-plt" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="variable-importance">Variable Importance<a class="anchor" aria-label="anchor" href="#variable-importance"></a>
</h2>
<p>See which features matter most:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Variable importance dataframe</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">importance</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="co">#&gt;   variable relative_importance scaled_importance importance</span></span>
<span><span class="co">#&gt; 1      Sex           573.43451         1.0000000 0.27116769</span></span>
<span><span class="co">#&gt; 2     Fare           498.60776         0.8695113 0.23578336</span></span>
<span><span class="co">#&gt; 3      Age           452.46356         0.7890414 0.21396253</span></span>
<span><span class="co">#&gt; 4   Pclass           277.21085         0.4834220 0.13108842</span></span>
<span><span class="co">#&gt; 5    SibSp           118.29958         0.2063001 0.05594192</span></span>
<span><span class="co">#&gt; 6 Embarked           114.79391         0.2001866 0.05428414</span></span>
<span><span class="co">#&gt; 7    Parch            79.87578         0.1392936 0.03777193</span></span>
<span></span>
<span><span class="co"># Plot top 15 important variables</span></span>
<span><span class="va">top15</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">model</span><span class="op">$</span><span class="va">importance</span>, <span class="fl">15</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/mplot_importance.html">mplot_importance</a></span><span class="op">(</span></span>
<span>  var <span class="op">=</span> <span class="va">top15</span><span class="op">$</span><span class="va">variable</span>,</span>
<span>  imp <span class="op">=</span> <span class="va">top15</span><span class="op">$</span><span class="va">importance</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="machine-learning_files/figure-html/unnamed-chunk-9-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level2">
<h2 id="model-interpretation-with-shap">Model Interpretation with SHAP<a class="anchor" aria-label="anchor" href="#model-interpretation-with-shap"></a>
</h2>
<p>SHAP values explain individual predictions:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Calculate SHAP values (computationally expensive)</span></span>
<span><span class="va">shap</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/h2o_shap.html">h2o_shap</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot SHAP summary</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">shap</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="advanced-customizing-automl">Advanced: Customizing AutoML<a class="anchor" aria-label="anchor" href="#advanced-customizing-automl"></a>
</h2>
<div class="section level3">
<h3 id="preprocessing-options">Preprocessing Options<a class="anchor" aria-label="anchor" href="#preprocessing-options"></a>
</h3>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/h2o_automl.html">h2o_automl</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">dft</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Survived"</span>,</span>
<span>  <span class="co"># Ignore specific columns</span></span>
<span>  ignore <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Ticket"</span>, <span class="st">"Cabin"</span>, <span class="st">"PassengerId"</span><span class="op">)</span>,</span>
<span>  <span class="co"># Use only specific algorithms (exclude_algos also available)</span></span>
<span>  include_algos <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"GBM"</span>, <span class="st">"DRF"</span><span class="op">)</span>, <span class="co"># Gradient Boosting &amp; Random Forest</span></span>
<span>  <span class="co"># Data split</span></span>
<span>  split <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  <span class="co"># Handle imbalanced data</span></span>
<span>  balance <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="co"># Remove outliers (Z-score &gt; 3)</span></span>
<span>  no_outliers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="co"># Impute missing values (requires mice package if TRUE)</span></span>
<span>  impute <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="co"># Keep only unique training rows</span></span>
<span>  unique_train <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  <span class="co"># Reproducible results</span></span>
<span>  seed <span class="op">=</span> <span class="fl">123</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   tag       n     p order  pcum</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> FALSE   549  61.6     1  61.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> TRUE    342  38.4     2 100</span></span>
<span><span class="co">#&gt; train_size  test_size </span></span>
<span><span class="co">#&gt;        623        268</span></span>
<span><span class="co">#&gt;                         model_id       auc   logloss     aucpr</span></span>
<span><span class="co">#&gt; 1 GBM_2_AutoML_2_20251125_181409 0.8596583 0.4248255 0.8431084</span></span>
<span><span class="co">#&gt; 2 DRF_1_AutoML_2_20251125_181409 0.8564385 0.4488829 0.8421588</span></span>
<span><span class="co">#&gt; 3 GBM_1_AutoML_2_20251125_181409 0.8328975 0.4839880 0.8085889</span></span>
<span><span class="co">#&gt;   mean_per_class_error      rmse       mse</span></span>
<span><span class="co">#&gt; 1            0.1960698 0.3625182 0.1314194</span></span>
<span><span class="co">#&gt; 2            0.1961569 0.3699173 0.1368388</span></span>
<span><span class="co">#&gt; 3            0.2342388 0.3942838 0.1554597</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Model (1/3): GBM_2_AutoML_2_20251125_181409</span></span>
<span><span class="co">#&gt; Dependent Variable: Survived</span></span>
<span><span class="co">#&gt; Type: Classification (2 classes)</span></span>
<span><span class="co">#&gt; Algorithm: GBM</span></span>
<span><span class="co">#&gt; Split: 70% training data (of 891 observations)</span></span>
<span><span class="co">#&gt; Seed: 123</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test metrics:</span></span>
<span><span class="co">#&gt;    AUC = 0.87879</span></span>
<span><span class="co">#&gt;    ACC = 0.86567</span></span>
<span><span class="co">#&gt;    PRC = 0.88506</span></span>
<span><span class="co">#&gt;    TPR = 0.74757</span></span>
<span><span class="co">#&gt;    TNR = 0.93939</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Most important variables:</span></span>
<span><span class="co">#&gt;    Sex (37.5%)</span></span>
<span><span class="co">#&gt;    Fare (22.7%)</span></span>
<span><span class="co">#&gt;    Age (17.3%)</span></span>
<span><span class="co">#&gt;    Pclass (12.2%)</span></span>
<span><span class="co">#&gt;    Embarked (4.1%)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="multi-class-classification">Multi-Class Classification<a class="anchor" aria-label="anchor" href="#multi-class-classification"></a>
</h2>
<p>Predict passenger class (3 categories):</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_multiclass</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/h2o_automl.html">h2o_automl</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">dft</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Pclass"</span>,</span>
<span>  ignore <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cabin"</span>, <span class="st">"PassengerId"</span><span class="op">)</span>,</span>
<span>  max_models <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  max_time <span class="op">=</span> <span class="fl">60</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 5</span></span></span>
<span><span class="co">#&gt;   tag       n     p order  pcum</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> n_3     491  55.1     1  55.1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> n_1     216  24.2     2  79.4</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> n_2     184  20.6     3 100</span></span>
<span><span class="co">#&gt; train_size  test_size </span></span>
<span><span class="co">#&gt;        623        268</span></span>
<span><span class="co">#&gt;                             model_id mean_per_class_error   logloss      rmse</span></span>
<span><span class="co">#&gt; 1 XGBoost_3_AutoML_3_20251125_181419           0.09289876 0.1804007 0.2314263</span></span>
<span><span class="co">#&gt; 2 XGBoost_2_AutoML_3_20251125_181419           0.10536260 0.2187613 0.2551008</span></span>
<span><span class="co">#&gt; 3 XGBoost_1_AutoML_3_20251125_181419           0.12322558 0.2639068 0.2795409</span></span>
<span><span class="co">#&gt;          mse</span></span>
<span><span class="co">#&gt; 1 0.05355812</span></span>
<span><span class="co">#&gt; 2 0.06507641</span></span>
<span><span class="co">#&gt; 3 0.07814310</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Model (1/10): XGBoost_3_AutoML_3_20251125_181419</span></span>
<span><span class="co">#&gt; Dependent Variable: Pclass</span></span>
<span><span class="co">#&gt; Type: Classification (3 classes)</span></span>
<span><span class="co">#&gt; Algorithm: XGBOOST</span></span>
<span><span class="co">#&gt; Split: 70% training data (of 891 observations)</span></span>
<span><span class="co">#&gt; Seed: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test metrics:</span></span>
<span><span class="co">#&gt;    AUC = 0.98276</span></span>
<span><span class="co">#&gt;    ACC = 0.93284</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Most important variables:</span></span>
<span><span class="co">#&gt;    Fare (69.3%)</span></span>
<span><span class="co">#&gt;    Age (13.5%)</span></span>
<span><span class="co">#&gt;    SibSp (7.4%)</span></span>
<span><span class="co">#&gt;    Parch (4.3%)</span></span>
<span><span class="co">#&gt;    Survived.TRUE (1.7%)</span></span>
<span></span>
<span><span class="co"># Multi-class metrics</span></span>
<span><span class="va">model_multiclass</span><span class="op">$</span><span class="va">metrics</span></span>
<span><span class="co">#&gt; $dictionary</span></span>
<span><span class="co">#&gt; [1] "AUC: Area Under the Curve"                                                             </span></span>
<span><span class="co">#&gt; [2] "ACC: Accuracy"                                                                         </span></span>
<span><span class="co">#&gt; [3] "PRC: Precision = Positive Predictive Value"                                            </span></span>
<span><span class="co">#&gt; [4] "TPR: Sensitivity = Recall = Hit rate = True Positive Rate"                             </span></span>
<span><span class="co">#&gt; [5] "TNR: Specificity = Selectivity = True Negative Rate"                                   </span></span>
<span><span class="co">#&gt; [6] "Logloss (Error): Logarithmic loss [Neutral classification: 0.69315]"                   </span></span>
<span><span class="co">#&gt; [7] "Gain: When best n deciles selected, what % of the real target observations are picked?"</span></span>
<span><span class="co">#&gt; [8] "Lift: When best n deciles selected, how much better than random is?"                   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $confusion_matrix</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 4</span></span></span>
<span><span class="co">#&gt;   `Real x Pred`   n_3   n_1   n_2</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> n_3             137     2     3</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> n_1               1    61     1</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> n_2               5     6    52</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metrics</span></span>
<span><span class="co">#&gt;       AUC     ACC</span></span>
<span><span class="co">#&gt; 1 0.98276 0.93284</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metrics_tags</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 3 × 9</span></span></span>
<span><span class="co">#&gt;   tag       n     p   AUC order   ACC   PRC   TPR   TNR</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> n_3     142  53.0 0.986     1 0.959 0.958 0.965 0.952</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> n_1      63  23.5 0.984     2 0.963 0.884 0.968 0.961</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> n_2      63  23.5 0.979     3 0.944 0.929 0.825 0.980</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cv_metrics</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 12 × 8</span></span></span>
<span><span class="co">#&gt;    metric     mean     sd cv_1_valid cv_2_valid cv_3_valid cv_4_valid cv_5_valid</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> accur…   0.931  0.029<span style="text-decoration: underline;">0</span>     0.944      0.944      0.944      0.879      0.944 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> auc    <span style="color: #BB0000;">NaN</span>      0        <span style="color: #BB0000;">NaN</span>        <span style="color: #BB0000;">NaN</span>        <span style="color: #BB0000;">NaN</span>        <span style="color: #BB0000;">NaN</span>        <span style="color: #BB0000;">NaN</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> err      0.069<span style="text-decoration: underline;">1</span> 0.029<span style="text-decoration: underline;">0</span>     0.056      0.056      0.056      0.121      0.056<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> err_c…   8.6    3.58       7          7          7         15          7     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> loglo…   0.181  0.089<span style="text-decoration: underline;">8</span>     0.152      0.195      0.124      0.329      0.102 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> max_p…   0.183  0.082<span style="text-decoration: underline;">3</span>     0.133      0.125      0.136      0.32       0.2   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> mean_…   0.907  0.044<span style="text-decoration: underline;">4</span>     0.933      0.926      0.936      0.830      0.909 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> mean_…   0.093<span style="text-decoration: underline;">1</span> 0.044<span style="text-decoration: underline;">4</span>     0.066<span style="text-decoration: underline;">6</span>     0.073<span style="text-decoration: underline;">9</span>     0.064<span style="text-decoration: underline;">0</span>     0.170      0.090<span style="text-decoration: underline;">5</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> mse      0.053<span style="text-decoration: underline;">6</span> 0.026<span style="text-decoration: underline;">8</span>     0.042<span style="text-decoration: underline;">9</span>     0.055<span style="text-decoration: underline;">9</span>     0.039<span style="text-decoration: underline;">9</span>     0.098<span style="text-decoration: underline;">7</span>     0.030<span style="text-decoration: underline;">6</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> pr_auc <span style="color: #BB0000;">NaN</span>      0        <span style="color: #BB0000;">NaN</span>        <span style="color: #BB0000;">NaN</span>        <span style="color: #BB0000;">NaN</span>        <span style="color: #BB0000;">NaN</span>        <span style="color: #BB0000;">NaN</span>     </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> r2       0.924  0.038<span style="text-decoration: underline;">1</span>     0.934      0.919      0.944      0.861      0.960 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> rmse     0.226  0.053<span style="text-decoration: underline;">7</span>     0.207      0.236      0.200      0.314      0.175 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $hit_ratio</span></span>
<span><span class="co">#&gt;   k hit_ratio</span></span>
<span><span class="co">#&gt; 1 1 0.9309791</span></span>
<span><span class="co">#&gt; 2 2 0.9919743</span></span>
<span><span class="co">#&gt; 3 3 1.0000000</span></span>
<span></span>
<span><span class="co"># Confusion matrix for multi-class</span></span>
<span><span class="fu"><a href="../reference/mplot_conf.html">mplot_conf</a></span><span class="op">(</span></span>
<span>  tag <span class="op">=</span> <span class="va">model_multiclass</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">tag</span>,</span>
<span>  score <span class="op">=</span> <span class="va">model_multiclass</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">score</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="machine-learning_files/figure-html/unnamed-chunk-12-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level2">
<h2 id="regression-example">Regression Example<a class="anchor" aria-label="anchor" href="#regression-example"></a>
</h2>
<p>Predict fare prices:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model_regression</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/h2o_automl.html">h2o_automl</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">dft</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Fare"</span>,</span>
<span>  ignore <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Cabin"</span>, <span class="st">"PassengerId"</span><span class="op">)</span>,</span>
<span>  max_models <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  exclude_algos <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;    Min. 1st Qu.  Median    Mean 3rd Qu.    Max. </span></span>
<span><span class="co">#&gt;    0.00    7.91   14.45   32.20   31.00  512.33</span></span>
<span><span class="co">#&gt; train_size  test_size </span></span>
<span><span class="co">#&gt;        609        262</span></span>
<span><span class="co">#&gt;                                                  model_id     rmse      mse</span></span>
<span><span class="co">#&gt; 1 StackedEnsemble_BestOfFamily_1_AutoML_4_20251125_181438 10.34827 107.0866</span></span>
<span><span class="co">#&gt; 2    StackedEnsemble_AllModels_1_AutoML_4_20251125_181438 10.51049 110.4704</span></span>
<span><span class="co">#&gt; 3                          GBM_3_AutoML_4_20251125_181438 12.44341 154.8385</span></span>
<span><span class="co">#&gt;        mae     rmsle mean_residual_deviance</span></span>
<span><span class="co">#&gt; 1 5.531397 0.4519830               107.0866</span></span>
<span><span class="co">#&gt; 2 5.671656 0.4547420               110.4704</span></span>
<span><span class="co">#&gt; 3 5.769395 0.4650435               154.8385</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Model (1/12): StackedEnsemble_BestOfFamily_1_AutoML_4_20251125_181438</span></span>
<span><span class="co">#&gt; Dependent Variable: Fare</span></span>
<span><span class="co">#&gt; Type: Regression</span></span>
<span><span class="co">#&gt; Algorithm: STACKEDENSEMBLE</span></span>
<span><span class="co">#&gt; Split: 70% training data (of 871 observations)</span></span>
<span><span class="co">#&gt; Seed: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test metrics:</span></span>
<span><span class="co">#&gt;    rmse = 6.7991</span></span>
<span><span class="co">#&gt;    mae = 4.258</span></span>
<span><span class="co">#&gt;    mape = 0.012981</span></span>
<span><span class="co">#&gt;    mse = 46.228</span></span>
<span><span class="co">#&gt;    rsq = 0.9357</span></span>
<span><span class="co">#&gt;    rsqa = 0.9355</span></span>
<span></span>
<span><span class="co"># Regression metrics</span></span>
<span><span class="va">model_regression</span><span class="op">$</span><span class="va">metrics</span></span>
<span><span class="co">#&gt; $dictionary</span></span>
<span><span class="co">#&gt; [1] "RMSE: Root Mean Squared Error"       </span></span>
<span><span class="co">#&gt; [2] "MAE: Mean Average Error"             </span></span>
<span><span class="co">#&gt; [3] "MAPE: Mean Absolute Percentage Error"</span></span>
<span><span class="co">#&gt; [4] "MSE: Mean Squared Error"             </span></span>
<span><span class="co">#&gt; [5] "RSQ: R Squared"                      </span></span>
<span><span class="co">#&gt; [6] "RSQA: Adjusted R Squared"            </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metrics</span></span>
<span><span class="co">#&gt;       rmse   mae       mape      mse    rsq   rsqa</span></span>
<span><span class="co">#&gt; 1 6.799092 4.258 0.01298087 46.22766 0.9357 0.9355</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cv_metrics</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 8 × 8</span></span></span>
<span><span class="co">#&gt;   metric     mean      sd cv_1_valid cv_2_valid cv_3_valid cv_4_valid cv_5_valid</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> mae     5.56<span style="color: #949494;">e</span>+0 6.45<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>      5.38       4.79       5.50       6.58       5.56 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> mean_r… 1.07<span style="color: #949494;">e</span>+2 5.02<span style="color: #949494;">e</span>+1     77.3       76.0      108.       194.        81.8  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">3</span> mse     1.07<span style="color: #949494;">e</span>+2 5.02<span style="color: #949494;">e</span>+1     77.3       76.0      108.       194.        81.8  </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">4</span> null_d… 1.19<span style="color: #949494;">e</span>+5 2.29<span style="color: #949494;">e</span>+4  <span style="text-decoration: underline;">89</span>084.    <span style="text-decoration: underline;">111</span>869.    <span style="text-decoration: underline;">147</span>015.    <span style="text-decoration: underline;">109</span>745.    <span style="text-decoration: underline;">135</span>751.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">5</span> r2      8.85<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span> 5.96<span style="color: #949494;">e</span><span style="color: #BB0000;">-2</span>      0.887      0.910      0.915      0.782      0.930</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">6</span> residu… 1.30<span style="color: #949494;">e</span>+4 6.06<span style="color: #949494;">e</span>+3   <span style="text-decoration: underline;">9</span>745.     <span style="text-decoration: underline;">10</span>030.     <span style="text-decoration: underline;">12</span>320.     <span style="text-decoration: underline;">23</span>686.      <span style="text-decoration: underline;">9</span>412.   </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">7</span> rmse    1.02<span style="color: #949494;">e</span>+1 2.21<span style="color: #949494;">e</span>+0      8.79       8.72      10.4       13.9        9.05 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">8</span> rmsle   4.44<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span> 1.21<span style="color: #949494;">e</span><span style="color: #BB0000;">-1</span>      0.456      0.264      0.425      0.473      0.601</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="using-pre-split-data">Using Pre-Split Data<a class="anchor" aria-label="anchor" href="#using-pre-split-data"></a>
</h2>
<p>If you have predefined train/test splits:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create splits</span></span>
<span><span class="va">splits</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msplit.html">msplit</a></span><span class="op">(</span><span class="va">dft</span>, size <span class="op">=</span> <span class="fl">0.8</span>, seed <span class="op">=</span> <span class="fl">123</span><span class="op">)</span></span>
<span><span class="co">#&gt; train_size  test_size </span></span>
<span><span class="co">#&gt;        712        179</span></span>
<span><span class="va">splits</span><span class="op">$</span><span class="va">train</span><span class="op">$</span><span class="va">split</span> <span class="op">&lt;-</span> <span class="st">"train"</span></span>
<span><span class="va">splits</span><span class="op">$</span><span class="va">test</span><span class="op">$</span><span class="va">split</span> <span class="op">&lt;-</span> <span class="st">"test"</span></span>
<span></span>
<span><span class="co"># Combine</span></span>
<span><span class="va">df_split</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">splits</span><span class="op">$</span><span class="va">train</span>, <span class="va">splits</span><span class="op">$</span><span class="va">test</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Train using split column</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/h2o_automl.html">h2o_automl</a></span><span class="op">(</span></span>
<span>  df <span class="op">=</span> <span class="va">df_split</span>,</span>
<span>  y <span class="op">=</span> <span class="st">"Survived"</span>,</span>
<span>  train_test <span class="op">=</span> <span class="st">"split"</span>,</span>
<span>  max_models <span class="op">=</span> <span class="fl">5</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   tag       n     p order  pcum</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> FALSE   549  61.6     1  61.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> TRUE    342  38.4     2 100</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;  test train </span></span>
<span><span class="co">#&gt;   179   712</span></span>
<span><span class="co">#&gt;                             model_id       auc   logloss     aucpr</span></span>
<span><span class="co">#&gt; 1     DRF_1_AutoML_5_20251125_181452 0.8680875 0.7855203 0.8270861</span></span>
<span><span class="co">#&gt; 2     GLM_1_AutoML_5_20251125_181452 0.8654726 0.4253319 0.8491966</span></span>
<span><span class="co">#&gt; 3 XGBoost_2_AutoML_5_20251125_181452 0.8552476 0.4437635 0.8198820</span></span>
<span><span class="co">#&gt;   mean_per_class_error      rmse       mse</span></span>
<span><span class="co">#&gt; 1            0.1775527 0.3813365 0.1454175</span></span>
<span><span class="co">#&gt; 2            0.1923547 0.3652137 0.1333811</span></span>
<span><span class="co">#&gt; 3            0.2036507 0.3736082 0.1395831</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Model (1/5): DRF_1_AutoML_5_20251125_181452</span></span>
<span><span class="co">#&gt; Dependent Variable: Survived</span></span>
<span><span class="co">#&gt; Type: Classification (2 classes)</span></span>
<span><span class="co">#&gt; Algorithm: DRF</span></span>
<span><span class="co">#&gt; Split: 80% training data (of 891 observations)</span></span>
<span><span class="co">#&gt; Seed: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test metrics:</span></span>
<span><span class="co">#&gt;    AUC = 0.85792</span></span>
<span><span class="co">#&gt;    ACC = 0.78212</span></span>
<span><span class="co">#&gt;    PRC = 0.84783</span></span>
<span><span class="co">#&gt;    TPR = 0.5493</span></span>
<span><span class="co">#&gt;    TNR = 0.93519</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Most important variables:</span></span>
<span><span class="co">#&gt;    Ticket (65.7%)</span></span>
<span><span class="co">#&gt;    Sex (14.9%)</span></span>
<span><span class="co">#&gt;    Cabin (8.7%)</span></span>
<span><span class="co">#&gt;    Pclass (3.4%)</span></span>
<span><span class="co">#&gt;    Fare (2.7%)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="making-predictions">Making Predictions<a class="anchor" aria-label="anchor" href="#making-predictions"></a>
</h2>
<div class="section level3">
<h3 id="on-new-data">On New Data<a class="anchor" aria-label="anchor" href="#on-new-data"></a>
</h3>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># New data (same structure as training)</span></span>
<span><span class="va">new_data</span> <span class="op">&lt;-</span> <span class="va">dft</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span>
<span></span>
<span><span class="co"># Predict</span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/h2o_predict.html">h2o_predict_model</a></span><span class="op">(</span><span class="va">new_data</span>, <span class="va">model</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">)</span></span>
<span><span class="co">#&gt;   predict     FALSE.        TRUE.</span></span>
<span><span class="co">#&gt; 1   FALSE 0.99979242 0.0002075763</span></span>
<span><span class="co">#&gt; 2    TRUE 0.02148936 0.9785106383</span></span>
<span><span class="co">#&gt; 3    TRUE 0.12765957 0.8723404255</span></span>
<span><span class="co">#&gt; 4    TRUE 0.09574468 0.9042553191</span></span>
<span><span class="co">#&gt; 5   FALSE 0.99979242 0.0002075763</span></span>
<span><span class="co">#&gt; 6   FALSE 0.97851583 0.0214841721</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="binary-model-predictions">Binary Model Predictions<a class="anchor" aria-label="anchor" href="#binary-model-predictions"></a>
</h3>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Get probabilities</span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/h2o_predict.html">h2o_predict_model</a></span><span class="op">(</span><span class="va">new_data</span>, <span class="va">model</span><span class="op">$</span><span class="va">model</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">predictions</span><span class="op">)</span></span>
<span><span class="co">#&gt;   predict     FALSE.        TRUE.</span></span>
<span><span class="co">#&gt; 1   FALSE 0.99979242 0.0002075763</span></span>
<span><span class="co">#&gt; 2    TRUE 0.02148936 0.9785106383</span></span>
<span><span class="co">#&gt; 3    TRUE 0.12765957 0.8723404255</span></span>
<span><span class="co">#&gt; 4    TRUE 0.09574468 0.9042553191</span></span>
<span><span class="co">#&gt; 5   FALSE 0.99979242 0.0002075763</span></span>
<span><span class="co">#&gt; 6   FALSE 0.97851583 0.0214841721</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="model-comparison">Model Comparison<a class="anchor" aria-label="anchor" href="#model-comparison"></a>
</h2>
<div class="section level3">
<h3 id="full-visualization-suite">Full Visualization Suite<a class="anchor" aria-label="anchor" href="#full-visualization-suite"></a>
</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Complete model evaluation plots</span></span>
<span><span class="fu"><a href="../reference/mplot_full.html">mplot_full</a></span><span class="op">(</span></span>
<span>  tag <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">tag</span>,</span>
<span>  score <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">score</span>,</span>
<span>  subtitle <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">model</span><span class="op">@</span><span class="va">algorithm</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="machine-learning_files/figure-html/unnamed-chunk-17-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level3">
<h3 id="metrics-comparison">Metrics Comparison<a class="anchor" aria-label="anchor" href="#metrics-comparison"></a>
</h3>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Model performance over trees</span></span>
<span><span class="fu"><a href="../reference/mplot_metrics.html">mplot_metrics</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></span></code></pre></div>
<p><img src="machine-learning_files/figure-html/unnamed-chunk-18-1.png" class="r-plt" width="672"></p>
</div>
</div>
<div class="section level2">
<h2 id="saving-and-loading-models">Saving and Loading Models<a class="anchor" aria-label="anchor" href="#saving-and-loading-models"></a>
</h2>
<div class="section level3">
<h3 id="export-results">Export Results<a class="anchor" aria-label="anchor" href="#export-results"></a>
</h3>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save model and plots</span></span>
<span><span class="fu"><a href="../reference/export_results.html">export_results</a></span><span class="op">(</span><span class="va">model</span>, subdir <span class="op">=</span> <span class="st">"models"</span>, thresh <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
<p>This creates: - Model file (.rds) - MOJO file (for production) -
Performance plots - Metrics summary</p>
</div>
<div class="section level3">
<h3 id="load-saved-model">Load Saved Model<a class="anchor" aria-label="anchor" href="#load-saved-model"></a>
</h3>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Load model</span></span>
<span><span class="va">loaded_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="st">"models/Titanic_Model/Titanic_Model.rds"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Make predictions with MOJO (production-ready)</span></span>
<span><span class="va">predictions</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/h2o_predict.html">h2o_predict_MOJO</a></span><span class="op">(</span></span>
<span>  model_path <span class="op">=</span> <span class="st">"models/Titanic_Model"</span>,</span>
<span>  df <span class="op">=</span> <span class="va">dft</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="op">]</span></span>
<span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="best-practices">Best Practices<a class="anchor" aria-label="anchor" href="#best-practices"></a>
</h2>
<div class="section level3">
<h3 id="start-simple">1. Start Simple<a class="anchor" aria-label="anchor" href="#start-simple"></a>
</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Quick prototype</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/h2o_automl.html">h2o_automl</a></span><span class="op">(</span><span class="va">dft</span>, <span class="st">"Survived"</span>, max_models <span class="op">=</span> <span class="fl">3</span>, max_time <span class="op">=</span> <span class="fl">30</span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   tag       n     p order  pcum</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> FALSE   549  61.6     1  61.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> TRUE    342  38.4     2 100</span></span>
<span><span class="co">#&gt; train_size  test_size </span></span>
<span><span class="co">#&gt;        623        268</span></span>
<span><span class="co">#&gt;                             model_id       auc   logloss     aucpr</span></span>
<span><span class="co">#&gt; 1     GLM_1_AutoML_6_20251125_181515 0.8566401 0.4331878 0.8468753</span></span>
<span><span class="co">#&gt; 2 XGBoost_1_AutoML_6_20251125_181515 0.8410859 0.4576161 0.8238591</span></span>
<span><span class="co">#&gt; 3     GBM_1_AutoML_6_20251125_181515 0.8159377 0.6451460 0.7378534</span></span>
<span><span class="co">#&gt;   mean_per_class_error      rmse       mse</span></span>
<span><span class="co">#&gt; 1            0.1914171 0.3680368 0.1354511</span></span>
<span><span class="co">#&gt; 2            0.2036044 0.3771717 0.1422585</span></span>
<span><span class="co">#&gt; 3            0.2218336 0.4732407 0.2239567</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Model (1/3): GLM_1_AutoML_6_20251125_181515</span></span>
<span><span class="co">#&gt; Dependent Variable: Survived</span></span>
<span><span class="co">#&gt; Type: Classification (2 classes)</span></span>
<span><span class="co">#&gt; Algorithm: GLM</span></span>
<span><span class="co">#&gt; Split: 70% training data (of 891 observations)</span></span>
<span><span class="co">#&gt; Seed: 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Test metrics:</span></span>
<span><span class="co">#&gt;    AUC = 0.87979</span></span>
<span><span class="co">#&gt;    ACC = 0.79851</span></span>
<span><span class="co">#&gt;    PRC = 0.90164</span></span>
<span><span class="co">#&gt;    TPR = 0.53398</span></span>
<span><span class="co">#&gt;    TNR = 0.96364</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Most important variables:</span></span>
<span><span class="co">#&gt;    Ticket.1601 (0.9%)</span></span>
<span><span class="co">#&gt;    Ticket.2661 (0.9%)</span></span>
<span><span class="co">#&gt;    Ticket.C.A. 37671 (0.8%)</span></span>
<span><span class="co">#&gt;    Cabin.C22 C26 (0.8%)</span></span>
<span><span class="co">#&gt;    Sex.female (0.7%)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="iterate-and-refine">2. Iterate and Refine<a class="anchor" aria-label="anchor" href="#iterate-and-refine"></a>
</h3>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Refine based on results</span></span>
<span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/h2o_automl.html">h2o_automl</a></span><span class="op">(</span></span>
<span>  <span class="va">dft</span>, <span class="st">"Survived"</span>,</span>
<span>  max_models <span class="op">=</span> <span class="fl">20</span>,</span>
<span>  no_outliers <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  balance <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  ignore <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"PassengerId"</span>, <span class="st">"Name"</span>, <span class="st">"Ticket"</span>, <span class="st">"Cabin"</span><span class="op">)</span>,</span>
<span>  model_name <span class="op">=</span> <span class="st">"Titanic_Model"</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 2 × 5</span></span></span>
<span><span class="co">#&gt;   tag       n     p order  pcum</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;lgl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> FALSE   549  61.6     1  61.6</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">2</span> TRUE    342  38.4     2 100</span></span>
<span><span class="co">#&gt; train_size  test_size </span></span>
<span><span class="co">#&gt;        623        268</span></span>
<span><span class="co">#&gt;                         model_id       auc   logloss     aucpr</span></span>
<span><span class="co">#&gt; 1 GBM_3_AutoML_7_20251125_181525 0.8575063 0.4316748 0.8410436</span></span>
<span><span class="co">#&gt; 2 GBM_2_AutoML_7_20251125_181525 0.8571250 0.4270731 0.8442881</span></span>
<span><span class="co">#&gt; 3 GBM_4_AutoML_7_20251125_181525 0.8561498 0.4266892 0.8469913</span></span>
<span><span class="co">#&gt;   mean_per_class_error      rmse       mse</span></span>
<span><span class="co">#&gt; 1            0.1887694 0.3656777 0.1337202</span></span>
<span><span class="co">#&gt; 2            0.1944735 0.3641046 0.1325721</span></span>
<span><span class="co">#&gt; 3            0.1909050 0.3631896 0.1319067</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |======================================================================| 100%</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="validate-thoroughly">3. Validate Thoroughly<a class="anchor" aria-label="anchor" href="#validate-thoroughly"></a>
</h3>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Check multiple metrics</span></span>
<span><span class="va">model</span><span class="op">$</span><span class="va">metrics</span></span>
<span><span class="co">#&gt; $dictionary</span></span>
<span><span class="co">#&gt; [1] "AUC: Area Under the Curve"                                                             </span></span>
<span><span class="co">#&gt; [2] "ACC: Accuracy"                                                                         </span></span>
<span><span class="co">#&gt; [3] "PRC: Precision = Positive Predictive Value"                                            </span></span>
<span><span class="co">#&gt; [4] "TPR: Sensitivity = Recall = Hit rate = True Positive Rate"                             </span></span>
<span><span class="co">#&gt; [5] "TNR: Specificity = Selectivity = True Negative Rate"                                   </span></span>
<span><span class="co">#&gt; [6] "Logloss (Error): Logarithmic loss [Neutral classification: 0.69315]"                   </span></span>
<span><span class="co">#&gt; [7] "Gain: When best n deciles selected, what % of the real target observations are picked?"</span></span>
<span><span class="co">#&gt; [8] "Lift: When best n deciles selected, how much better than random is?"                   </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $confusion_matrix</span></span>
<span><span class="co">#&gt;        Pred</span></span>
<span><span class="co">#&gt; Real    FALSE TRUE</span></span>
<span><span class="co">#&gt;   FALSE   156    9</span></span>
<span><span class="co">#&gt;   TRUE     28   75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gain_lift</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 10 × 10</span></span></span>
<span><span class="co">#&gt;    percentile value random target total  gain optimal  lift response score</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> 1          FALSE   10.1     25    27  15.2    16.4  50.4   15.2   93.5 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> 2          FALSE   20.1     24    27  29.7    32.7  47.4   14.5   92.2 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> 3          FALSE   30.2     26    27  45.5    49.1  50.4   15.8   89.0 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> 4          FALSE   39.9     24    26  60      64.8  50.3   14.5   86.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> 5          FALSE   50       23    27  73.9    81.2  47.9   13.9   81.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> 6          FALSE   60.1     17    27  84.2    97.6  40.2   10.3   71.1 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> 7          FALSE   69.8     18    26  95.2   100    36.4   10.9   45.7 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> 8          FALSE   79.9      3    27  97.0   100    21.4    1.82  22.6 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> 9          FALSE   89.9      4    27  99.4   100    10.5    2.42   9.55</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> 10         FALSE  100        1    27 100     100     0      0.606  1.49</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $metrics</span></span>
<span><span class="co">#&gt;       AUC     ACC     PRC     TPR     TNR</span></span>
<span><span class="co">#&gt; 1 0.89147 0.86194 0.89286 0.72816 0.94545</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cv_metrics</span></span>
<span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 20 × 8</span></span></span>
<span><span class="co">#&gt;    metric     mean     sd cv_1_valid cv_2_valid cv_3_valid cv_4_valid cv_5_valid</span></span>
<span><span class="co">#&gt;    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>      <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 1</span> accuracy  0.836 0.046<span style="text-decoration: underline;">2</span>      0.84      0.896       0.8        0.782      0.863</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 2</span> auc       0.847 0.072<span style="text-decoration: underline;">1</span>      0.847     0.927       0.854      0.731      0.876</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 3</span> err       0.164 0.046<span style="text-decoration: underline;">2</span>      0.16      0.104       0.2        0.218      0.137</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 4</span> err_cou… 20.4   5.73       20        13          25         27         17    </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 5</span> f0point5  0.783 0.091<span style="text-decoration: underline;">4</span>      0.788     0.913       0.743      0.663      0.808</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 6</span> f1        0.781 0.079<span style="text-decoration: underline;">3</span>      0.778     0.876       0.779      0.658      0.813</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 7</span> f2        0.780 0.075<span style="text-decoration: underline;">9</span>      0.768     0.842       0.818      0.653      0.819</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 8</span> lift_to…  2.64  0.337       2.72      2.23        2.40       3.1        2.76 </span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;"> 9</span> logloss   0.432 0.082<span style="text-decoration: underline;">8</span>      0.452     0.326       0.460      0.543      0.379</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">10</span> max_per…  0.236 0.070<span style="text-decoration: underline;">2</span>      0.239     0.179       0.233      0.35       0.178</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">11</span> mcc       0.651 0.110       0.653     0.792       0.605      0.499      0.705</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">12</span> mean_pe…  0.824 0.053<span style="text-decoration: underline;">1</span>      0.823     0.889       0.807      0.748      0.854</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">13</span> mean_pe…  0.176 0.053<span style="text-decoration: underline;">1</span>      0.177     0.111       0.193      0.252      0.146</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">14</span> mse       0.134 0.029<span style="text-decoration: underline;">4</span>      0.139     0.096<span style="text-decoration: underline;">6</span>      0.145      0.173      0.115</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">15</span> pr_auc    0.822 0.098<span style="text-decoration: underline;">7</span>      0.821     0.937       0.814      0.669      0.870</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">16</span> precisi…  0.785 0.103       0.795     0.939       0.721      0.667      0.804</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">17</span> r2        0.425 0.149       0.403     0.610       0.402      0.207      0.503</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">18</span> recall    0.780 0.079<span style="text-decoration: underline;">3</span>      0.761     0.821       0.846      0.65       0.822</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">19</span> rmse      0.364 0.040<span style="text-decoration: underline;">5</span>      0.372     0.311       0.381      0.416      0.339</span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">20</span> specifi…  0.868 0.069<span style="text-decoration: underline;">3</span>      0.886     0.957       0.767      0.845      0.886</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $max_metrics</span></span>
<span><span class="co">#&gt;                         metric  threshold       value idx</span></span>
<span><span class="co">#&gt; 1                       max f1 0.41714863   0.7672956 181</span></span>
<span><span class="co">#&gt; 2                       max f2 0.28931884   0.7898957 224</span></span>
<span><span class="co">#&gt; 3                 max f0point5 0.66135190   0.8173619 120</span></span>
<span><span class="co">#&gt; 4                 max accuracy 0.61537557   0.8250401 130</span></span>
<span><span class="co">#&gt; 5                max precision 0.99256302   1.0000000   0</span></span>
<span><span class="co">#&gt; 6                   max recall 0.03108045   1.0000000 391</span></span>
<span><span class="co">#&gt; 7              max specificity 0.99256302   1.0000000   0</span></span>
<span><span class="co">#&gt; 8             max absolute_mcc 0.61537557   0.6277286 130</span></span>
<span><span class="co">#&gt; 9   max min_per_class_accuracy 0.35070798   0.7907950 205</span></span>
<span><span class="co">#&gt; 10 max mean_per_class_accuracy 0.41714863   0.8112306 181</span></span>
<span><span class="co">#&gt; 11                     max tns 0.99256302 384.0000000   0</span></span>
<span><span class="co">#&gt; 12                     max fns 0.99256302 238.0000000   0</span></span>
<span><span class="co">#&gt; 13                     max fps 0.01019947 384.0000000 399</span></span>
<span><span class="co">#&gt; 14                     max tps 0.03108045 239.0000000 391</span></span>
<span><span class="co">#&gt; 15                     max tnr 0.99256302   1.0000000   0</span></span>
<span><span class="co">#&gt; 16                     max fnr 0.99256302   0.9958159   0</span></span>
<span><span class="co">#&gt; 17                     max fpr 0.01019947   1.0000000 399</span></span>
<span><span class="co">#&gt; 18                     max tpr 0.03108045   1.0000000 391</span></span>
<span></span>
<span><span class="co"># Visual inspection</span></span>
<span><span class="fu"><a href="../reference/mplot_full.html">mplot_full</a></span><span class="op">(</span></span>
<span>  tag <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">tag</span>,</span>
<span>  score <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">score</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="machine-learning_files/figure-html/unnamed-chunk-23-1.png" class="r-plt" width="672"></p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="co"># Variable importance</span></span>
<span><span class="fu"><a href="../reference/mplot_importance.html">mplot_importance</a></span><span class="op">(</span></span>
<span>  var <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">importance</span><span class="op">$</span><span class="va">variable</span>,</span>
<span>  imp <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">importance</span><span class="op">$</span><span class="va">importance</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="machine-learning_files/figure-html/unnamed-chunk-23-2.png" class="r-plt" width="672"></p>
</div>
<div class="section level3">
<h3 id="score-distribution">Score Distribution<a class="anchor" aria-label="anchor" href="#score-distribution"></a>
</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Density plot</span></span>
<span><span class="fu"><a href="../reference/mplot_density.html">mplot_density</a></span><span class="op">(</span></span>
<span>  tag <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">tag</span>,</span>
<span>  score <span class="op">=</span> <span class="va">model</span><span class="op">$</span><span class="va">scores_test</span><span class="op">$</span><span class="va">score</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p><img src="machine-learning_files/figure-html/unnamed-chunk-24-1.png" class="r-plt" width="672"></p>
</div>
<div class="section level3">
<h3 id="document-your-process">4. Document Your Process<a class="anchor" aria-label="anchor" href="#document-your-process"></a>
</h3>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Save everything</span></span>
<span><span class="fu"><a href="../reference/export_results.html">export_results</a></span><span class="op">(</span><span class="va">model</span>, subdir <span class="op">=</span> <span class="st">"my_project"</span>, thresh <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="troubleshooting">Troubleshooting<a class="anchor" aria-label="anchor" href="#troubleshooting"></a>
</h2>
<div class="section level3">
<h3 id="h2o-initialization-issues">h2o Initialization Issues<a class="anchor" aria-label="anchor" href="#h2o-initialization-issues"></a>
</h3>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Manually initialize h2o with more memory</span></span>
<span><span class="fu">h2o</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.init.html" class="external-link">h2o.init</a></span><span class="op">(</span>max_mem_size <span class="op">=</span> <span class="st">"8G"</span>, nthreads <span class="op">=</span> <span class="op">-</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="co">#&gt;  Connection successful!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; R is connected to the H2O cluster: </span></span>
<span><span class="co">#&gt;     H2O cluster uptime:         2 minutes 16 seconds </span></span>
<span><span class="co">#&gt;     H2O cluster timezone:       UTC </span></span>
<span><span class="co">#&gt;     H2O data parsing timezone:  UTC </span></span>
<span><span class="co">#&gt;     H2O cluster version:        3.44.0.3 </span></span>
<span><span class="co">#&gt;     H2O cluster version age:    1 year, 11 months and 5 days </span></span>
<span><span class="co">#&gt;     H2O cluster name:           H2O_started_from_R_runner_mwl453 </span></span>
<span><span class="co">#&gt;     H2O cluster total nodes:    1 </span></span>
<span><span class="co">#&gt;     H2O cluster total memory:   1.93 GB </span></span>
<span><span class="co">#&gt;     H2O cluster total cores:    4 </span></span>
<span><span class="co">#&gt;     H2O cluster allowed cores:  4 </span></span>
<span><span class="co">#&gt;     H2O cluster healthy:        TRUE </span></span>
<span><span class="co">#&gt;     H2O Connection ip:          localhost </span></span>
<span><span class="co">#&gt;     H2O Connection port:        54321 </span></span>
<span><span class="co">#&gt;     H2O Connection proxy:       NA </span></span>
<span><span class="co">#&gt;     H2O Internal Security:      FALSE </span></span>
<span><span class="co">#&gt;     R Version:                  R version 4.5.2 (2025-10-31)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="clean-h2o-environment">Clean h2o Environment<a class="anchor" aria-label="anchor" href="#clean-h2o-environment"></a>
</h3>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove all models</span></span>
<span><span class="fu">h2o</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.removeAll.html" class="external-link">h2o.removeAll</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Shutdown h2o</span></span>
<span><span class="fu">h2o</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/h2o/man/h2o.shutdown.html" class="external-link">h2o.shutdown</a></span><span class="op">(</span>prompt <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="check-h2o-flow-ui">Check h2o Flow UI<a class="anchor" aria-label="anchor" href="#check-h2o-flow-ui"></a>
</h3>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Open h2o's web interface</span></span>
<span><span class="co"># Navigate to: http://localhost:54321/flow/index.html</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="further-reading">Further Reading<a class="anchor" aria-label="anchor" href="#further-reading"></a>
</h2>
<div class="section level3">
<h3 id="package-ml-resources">Package &amp; ML Resources<a class="anchor" aria-label="anchor" href="#package-ml-resources"></a>
</h3>
<ul>
<li>
<strong>h2o AutoML Documentation:</strong> <a href="https://docs.h2o.ai/h2o/latest-stable/h2o-docs/automl.html" class="external-link">https://docs.h2o.ai/h2o/latest-stable/h2o-docs/automl.html</a>
</li>
<li>
<strong>lares ML functions:</strong> <code><a href="../reference/h2o_automl.html">?h2o_automl</a></code>,
<code><a href="../reference/h2o_explainer.html">?h2o_explainer</a></code>, <code><a href="../reference/mplot_full.html">?mplot_full</a></code>
</li>
<li>
<strong>SHAP explanations:</strong> <a href="https://github.com/slundberg/shap" class="external-link">https://github.com/slundberg/shap</a>
</li>
</ul>
</div>
<div class="section level3">
<h3 id="blog-posts-tutorials">Blog Posts &amp; Tutorials<a class="anchor" aria-label="anchor" href="#blog-posts-tutorials"></a>
</h3>
<ul>
<li>
<a href="https://datascienceplus.com/machine-learning-results-one-plot-to-rule-them-all/" class="external-link">Machine
Learning Results: One Plot to Rule Them All</a> - Visualizing binary
classification results</li>
<li>
<a href="https://datascienceplus.com/machine-learning-results-in-r-one-plot-to-rule-them-all-part-2-regression-models/" class="external-link">Machine
Learning Results in R: One Plot to Rule Them All (Part 2 - Regression
Models)</a> - Regression model visualization</li>
<li>
<a href="https://datascienceplus.com/understanding-titanic-dataset-with-h2os-automl-dalex-and-lares-library/" class="external-link">Understanding
Titanic Dataset with H2O’s AutoML, DALEX and lares Library</a> -
Complete Titanic analysis walkthrough</li>
<li>Other lares articles <a href="https://datascienceplus.com/author/bernardo-lares/" class="external-link">on
DataScience+</a>
</li>
</ul>
</div>
</div>
<div class="section level2">
<h2 id="next-steps">Next Steps<a class="anchor" aria-label="anchor" href="#next-steps"></a>
</h2>
<ul>
<li>Explore data wrangling features (see Data Wrangling vignette)</li>
<li>Learn about API integrations (see API Integrations vignette)</li>
<li>Review individual plotting functions: <code><a href="../reference/mplot_conf.html">?mplot_conf</a></code>,
<code><a href="../reference/mplot_roc.html">?mplot_roc</a></code>, <code><a href="../reference/mplot_importance.html">?mplot_importance</a></code>
</li>
</ul>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Bernardo Lares.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
