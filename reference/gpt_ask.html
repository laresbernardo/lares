<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="This function lets the user ask ChatGPT via its API, and returns
the rendered reply. There are a couple of specific verbs (functions) with a
preset prompt to help fetch the data in specific formats. We also
store the prompts and replies in current session with their respective
time-stamps so user can gather historical results."><title>ChatGPT API Interaction with R — gpt_ask • lares</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="ChatGPT API Interaction with R — gpt_ask"><meta property="og:description" content="This function lets the user ask ChatGPT via its API, and returns
the rendered reply. There are a couple of specific verbs (functions) with a
preset prompt to help fetch the data in specific formats. We also
store the prompts and replies in current session with their respective
time-stamps so user can gather historical results."><meta property="og:image" content="https://laresbernardo.github.io/lares/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-166493168-2"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-166493168-2');
</script></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">lares</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">5.2.5.9002</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/h2o_automl.html">Introduction to AutoML using lares</a>
  </div>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/laresbernardo/lares/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>ChatGPT API Interaction with R</h1>
      <small class="dont-index">Source: <a href="https://github.com/laresbernardo/lares/blob/HEAD/R/chatgpt.R" class="external-link"><code>R/chatgpt.R</code></a></small>
      <div class="d-none name"><code>gpt_ask.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function lets the user ask ChatGPT via its API, and returns
the rendered reply. There are a couple of specific verbs (functions) with a
preset prompt to help fetch the data in specific formats. We also
store the prompts and replies in current session with their respective
time-stamps so user can gather historical results.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gpt_ask</span><span class="op">(</span></span>
<span>  <span class="va">ask</span>,</span>
<span>  secret_key <span class="op">=</span> <span class="fu"><a href="get_credentials.html">get_credentials</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">openai</span><span class="op">$</span><span class="va">secret_key</span>,</span>
<span>  url <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"LARES_GPT_URL"</span><span class="op">)</span>,</span>
<span>  model <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Sys.getenv.html" class="external-link">Sys.getenv</a></span><span class="op">(</span><span class="st">"LARES_GPT_MODEL"</span><span class="op">)</span>,</span>
<span>  num_retries <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  temperature <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  max_tokens <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  pause_base <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  <span class="va">...</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gpt_history</span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gpt_table</span><span class="op">(</span><span class="va">x</span>, cols <span class="op">=</span> <span class="cn">NULL</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gpt_classify</span><span class="op">(</span><span class="va">x</span>, <span class="va">categories</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gpt_tag</span><span class="op">(</span><span class="va">x</span>, <span class="va">tags</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gpt_extract</span><span class="op">(</span><span class="va">x</span>, <span class="va">extract</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gpt_format</span><span class="op">(</span><span class="va">x</span>, <span class="va">format</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gpt_convert</span><span class="op">(</span><span class="va">x</span>, <span class="va">unit</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">gpt_translate</span><span class="op">(</span><span class="va">x</span>, <span class="va">language</span>, quiet <span class="op">=</span> <span class="cn">TRUE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>ask</dt>
<dd><p>Character. Redacted prompt to ask ChatGPT. If multiple asks are
requested, they will be concatenated with "+" into a single request.</p></dd>


<dt>secret_key</dt>
<dd><p>Character. Secret Key. Get yours in:
<a href="https://platform.openai.com" class="external-link">platform.openai.com</a>.</p></dd>


<dt>url</dt>
<dd><p>Character. Base URL for OpenAI's ChatGPT API.</p></dd>


<dt>model</dt>
<dd><p>Character. OpenAI model to use. This can be adjusted
according to the available models in the OpenAI API (such as "gpt-4").</p></dd>


<dt>num_retries</dt>
<dd><p>Integer. Number of times to retry the request in
case of failure. Default is 3.</p></dd>


<dt>temperature</dt>
<dd><p>Numeric. The temperature to use for generating
the response. Default is 0.5. The lower the <code>temperature</code>,
the more deterministic the results in the sense that the highest probable
next token is always picked. Increasing temperature could lead to more
randomness, which encourages more diverse or creative outputs. You are
essentially increasing the weights of the other possible tokens.
In terms of application, you might want to use a lower temperature value
for tasks like fact-based QA to encourage more factual and concise responses.
For poem generation or other creative tasks, it might be beneficial to
increase the temperature value.</p></dd>


<dt>max_tokens</dt>
<dd><p>Integer. The maximum number of tokens in the response.</p></dd>


<dt>pause_base</dt>
<dd><p>Numeric. The number of seconds to wait between retries.
Default is 1.</p></dd>


<dt>quiet</dt>
<dd><p>Boolean. Keep quiet? If not, show informative messages.</p></dd>


<dt>...</dt>
<dd><p>Additional parameters.</p></dd>


<dt>x</dt>
<dd><p>Vector. List items you wish to process in your instruction</p></dd>


<dt>cols</dt>
<dd><p>Vector. Force column names for your table results.</p></dd>


<dt>categories, tags</dt>
<dd><p>Vector. List of possible categories/tags to consider.</p></dd>


<dt>extract, format, unit</dt>
<dd><p>Character. Length 1 or same as x to extract/format/unit
information from x. For example: email, country of phone number, country, amount as number,
currency ISO code, ISO, Fahrenheit, etc.</p></dd>


<dt>language</dt>
<dd><p>Character. Language to translate to</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>(Invisible) list. Content returned from API POST and processed.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p>Other API: 
<code><a href="bring_api.html">bring_api</a>()</code>,
<code><a href="fb_accounts.html">fb_accounts</a>()</code>,
<code><a href="fb_ads.html">fb_ads</a>()</code>,
<code><a href="fb_creatives.html">fb_creatives</a>()</code>,
<code><a href="fb_insights.html">fb_insights</a>()</code>,
<code><a href="fb_process.html">fb_process</a>()</code>,
<code><a href="fb_report_check.html">fb_report_check</a>()</code>,
<code><a href="fb_rf.html">fb_rf</a>()</code>,
<code><a href="fb_token.html">fb_token</a>()</code>,
<code><a href="gemini_ask.html">gemini_ask</a>()</code>,
<code><a href="li_auth.html">li_auth</a>()</code>,
<code><a href="li_profile.html">li_profile</a>()</code>,
<code><a href="queryGA.html">queryGA</a>()</code>,
<code><a href="slackSend.html">slackSend</a>()</code></p>
<p>Other ChatGPT: 
<code><a href="gpt_prompter.html">gpt_prompter</a>()</code></p>
<p>Other LLM: 
<code><a href="gemini_ask.html">gemini_ask</a>()</code>,
<code><a href="gpt_prompter.html">gpt_prompter</a>()</code></p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="va">api_key</span> <span class="op">&lt;-</span> <span class="fu"><a href="get_credentials.html">get_credentials</a></span><span class="op">(</span><span class="op">)</span><span class="op">$</span><span class="va">openai</span><span class="op">$</span><span class="va">secret_key</span></span></span>
<span class="r-in"><span><span class="co"># Open question:</span></span></span>
<span class="r-in"><span><span class="fu">gpt_ask</span><span class="op">(</span><span class="st">"Can you write an R function to plot a dummy histogram?"</span>, <span class="va">api_key</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">##### The following examples return dataframes:</span></span></span>
<span class="r-in"><span><span class="co"># Classify each element based on categories:</span></span></span>
<span class="r-in"><span><span class="fu">gpt_classify</span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">10</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"odd"</span>, <span class="st">"even"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Add all tags that apply to each element based on tags:</span></span></span>
<span class="r-in"><span><span class="fu">gpt_tag</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"I love chocolate"</span>, <span class="st">"I hate chocolate"</span>, <span class="st">"I like Coke"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"food"</span>, <span class="st">"positive"</span>, <span class="st">"negative"</span>, <span class="st">"beverage"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Extract specific information:</span></span></span>
<span class="r-in"><span><span class="fu">gpt_extract</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"My mail is 123@test.com"</span>, <span class="st">"30 Main Street, Brooklyn, NY, USA"</span>, <span class="st">"+82 2-312-3456"</span>, <span class="st">"$1.5M"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"email"</span>, <span class="st">"full state name"</span>, <span class="st">"country of phone number"</span>, <span class="st">"amount as number"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Format values</span></span></span>
<span class="r-in"><span><span class="fu">gpt_format</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"March 27th, 2021"</span>, <span class="st">"12-25-2023 3:45PM"</span>, <span class="st">"01.01.2000"</span>, <span class="st">"29 Feb 92"</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  format <span class="op">=</span> <span class="st">"ISO Date getting rid of time stamps"</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Convert temperature units</span></span></span>
<span class="r-in"><span><span class="fu">gpt_convert</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"50C"</span>, <span class="st">"300K"</span><span class="op">)</span>, <span class="st">"Fahrenheit"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Create a table with data</span></span></span>
<span class="r-in"><span><span class="fu">gpt_table</span><span class="op">(</span><span class="st">"5 random people's address in South America, email, phone, age between 18-30"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">gpt_table</span><span class="op">(</span></span></span>
<span class="r-in"><span>  ask <span class="op">=</span> <span class="st">"5 largest cities, their countries, and population"</span>,</span></span>
<span class="r-in"><span>  cols <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"city_name"</span>, <span class="st">"where"</span>, <span class="st">"POP"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Translate text to any language</span></span></span>
<span class="r-in"><span><span class="fu">gpt_translate</span><span class="op">(</span></span></span>
<span class="r-in"><span>  <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"I love you with all my heart"</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  language <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"spanish"</span>, <span class="st">"chinese"</span>, <span class="st">"japanese"</span>, <span class="st">"russian"</span>, <span class="st">"german"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Now let's read the historical prompts, replies, ano more from current session</span></span></span>
<span class="r-in"><span><span class="fu">gpt_history</span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Bernardo Lares.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

